<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PHP Backend Test - SIH 25031</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .form-container {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        input, textarea, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            box-sizing: border-box;
        }
        textarea {
            resize: vertical;
            min-height: 100px;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
        }
        button:hover {
            background-color: #0056b3;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        .status {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
        }
        .status-pending { background-color: #ffc107; color: #000; }
        .status-in-progress { background-color: #17a2b8; color: #fff; }
        .status-resolved { background-color: #28a745; color: #fff; }
        .status-closed { background-color: #6c757d; color: #fff; }
        .issue-card {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 6px;
            border-left: 4px solid #007bff;
        }
        .issue-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .issue-actions select {
            width: auto;
            min-width: 120px;
        }
        h1, h2 {
            color: #333;
            text-align: center;
        }
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            padding: 12px 20px;
            border-radius: 4px;
            color: white;
            font-weight: bold;
            max-width: 300px;
            word-wrap: break-word;
            cursor: pointer;
        }
        .notification-success { background-color: #28a745; }
        .notification-error { background-color: #dc3545; }
        .notification-info { background-color: #17a2b8; }
    </style>
</head>
<body>
    <h1>üèõÔ∏è SIH 25031 - PHP Backend Test</h1>
    <p style="text-align: center; color: #666;">Complete Civic Issues Reporting System with PHP + MySQL</p>

    <!-- Issue Report Form -->
    <div class="form-container">
        <h2>üìù Report Civic Issue</h2>
        <form id="issueReportForm" data-api="issue">
            <div class="form-group">
                <label for="name">Full Name *</label>
                <input type="text" id="name" name="name" required>
            </div>
            
            <div class="form-group">
                <label for="email">Email Address *</label>
                <input type="email" id="email" name="email" required>
            </div>
            
            <div class="form-group">
                <label for="phone">Phone Number</label>
                <input type="tel" id="phone" name="phone" placeholder="+91 9876543210">
            </div>
            
            <div class="form-group">
                <label for="title">Issue Title</label>
                <input type="text" id="title" name="title" placeholder="Brief title of the issue">
            </div>
            
            <div class="form-group">
                <label for="category">Issue Category *</label>
                <select id="category" name="category" required>
                    <option value="">Select Category</option>
                    <option value="roads">üöß Roads & Mining</option>
                    <option value="water">üö∞ Water & Sanitation</option>
                    <option value="electricity">üí° Electricity & Streetlights</option>
                    <option value="health">üè• Health & Ambulance</option>
                    <option value="education">üéì Education (Schools)</option>
                    <option value="farming">üßë‚Äçüåæ Farmer Support</option>
                    <option value="ration">üçö PDS / Ration Issues</option>
                    <option value="environment">üå≥ Environment & Forest</option>
                    <option value="safety">üö® Women & Child Safety</option>
                    <option value="transport">üöå Transport</option>
                    <option value="potholes">Potholes</option>
                    <option value="streetlights">Streetlights</option>
                    <option value="garbage">Garbage Collection</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="priority">Priority Level</label>
                <select id="priority" name="priority">
                    <option value="low">Low</option>
                    <option value="medium" selected>Medium</option>
                    <option value="high">High</option>
                    <option value="urgent">Urgent</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="location">Location *</label>
                <input type="text" id="location" name="location" placeholder="Area, City, State" required>
            </div>
            
            <div class="form-group">
                <label for="description">Issue Description *</label>
                <textarea id="description" name="description" required placeholder="Describe the issue in detail. Include any relevant information that can help authorities understand and resolve the problem."></textarea>
            </div>
            
            <div class="form-group">
                <label for="imageUrl">Image URL (optional)</label>
                <input type="url" id="imageUrl" name="imageUrl" placeholder="https://example.com/photo.jpg (if you have uploaded the image online)">
            </div>
            
            <button type="submit">Submit Issue Report</button>
        </form>
    </div>

    <!-- Feedback Form -->
    <div class="form-container">
        <h2>üí¨ Submit Feedback</h2>
        <form id="feedbackForm" data-api="feedback">
            <div class="form-group">
                <label for="feedback-name">Your Name *</label>
                <input type="text" id="feedback-name" name="name" required>
            </div>
            
            <div class="form-group">
                <label for="feedback-email">Your Email *</label>
                <input type="email" id="feedback-email" name="email" required>
            </div>
            
            <div class="form-group">
                <label for="rating">Rating</label>
                <select id="rating" name="rating">
                    <option value="1">‚≠ê 1 - Very Poor</option>
                    <option value="2">‚≠ê‚≠ê 2 - Poor</option>
                    <option value="3">‚≠ê‚≠ê‚≠ê 3 - Average</option>
                    <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê 4 - Good</option>
                    <option value="5" selected>‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 5 - Excellent</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="feedback-message">Your Feedback *</label>
                <textarea id="feedback-message" name="message" required placeholder="Share your experience with our civic reporting system..."></textarea>
            </div>
            
            <button type="submit">Submit Feedback</button>
        </form>
    </div>

    <!-- Tourism Report Form -->
    <div class="form-container">
        <h2>üèûÔ∏è Tourism Report</h2>
        <form id="tourismForm" data-api="tourism">
            <div class="form-group">
                <label for="tour-title">Report Title *</label>
                <input type="text" id="tour-title" name="title" required placeholder="e.g., Broken facilities at Ranchi Lake">
            </div>
            
            <div class="form-group">
                <label for="tour-location">Location *</label>
                <input type="text" id="tour-location" name="location" required placeholder="Tourist spot or area name">
            </div>
            
            <div class="form-group">
                <label for="tour-type">Report Type</label>
                <select id="tour-type" name="type">
                    <option value="safety">üö® Safety Issue</option>
                    <option value="cleanliness">üßπ Cleanliness</option>
                    <option value="facility">üèóÔ∏è Facility/Infrastructure</option>
                    <option value="feedback" selected>üí≠ General Feedback</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="tour-description">Description *</label>
                <textarea id="tour-description" name="description" required placeholder="Describe the issue or provide your feedback about the tourist location..."></textarea>
            </div>
            
            <div class="form-group">
                <label for="tour-contact">Contact (optional)</label>
                <input type="text" id="tour-contact" name="contact" placeholder="Phone or email for follow-up">
            </div>
            
            <button type="submit">Submit Tourism Report</button>
        </form>
    </div>

    <!-- Admin Dashboard - Issues List -->
    <div class="form-container">
        <h2>üèõÔ∏è Admin Dashboard - All Issues</h2>
        <button onclick="loadAllIssues()" style="width: auto; margin-bottom: 20px;">üîÑ Refresh Issues</button>
        <div id="issuesContainer">
            <p>Click "Refresh Issues" to load all reported issues...</p>
        </div>
    </div>

    <!-- PHP Integration Script -->
    <script src="php-integration.js"></script>
    
    <script>
        // Function to manually load issues (for testing)
        async function loadAllIssues() {
            const container = document.getElementById('issuesContainer');
            container.innerHTML = '<p>Loading issues...</p>';
            
            try {
                const result = await phpApiClient.getAllIssues();
                
                if (result.status === 'success' && result.data) {
                    if (result.data.length === 0) {
                        container.innerHTML = '<p>No issues reported yet. Submit an issue above to test!</p>';
                        return;
                    }
                    
                    container.innerHTML = result.data.map(issue => `
                        <div class="issue-card" data-issue-id="${issue.id}">
                            <div class="issue-header">
                                <h3>${issue.title || issue.category}</h3>
                                <span class="status status-${issue.status}">${issue.status}</span>
                            </div>
                            <div class="issue-content">
                                <p><strong>üë§ Reporter:</strong> ${issue.name}</p>
                                <p><strong>üìß Email:</strong> ${issue.email}</p>
                                ${issue.phone ? `<p><strong>üìû Phone:</strong> ${issue.phone}</p>` : ''}
                                <p><strong>üìç Location:</strong> ${issue.location || 'Not specified'}</p>
                                <p><strong>üî• Priority:</strong> ${issue.priority}</p>
                                <p><strong>üìÇ Category:</strong> ${issue.category}</p>
                                <p><strong>üìù Description:</strong> ${issue.description}</p>
                                <p><strong>üìÖ Date:</strong> ${new Date(issue.created_at).toLocaleDateString()}</p>
                                ${issue.image_url ? `<p><strong>üñºÔ∏è Image:</strong> <a href="${issue.image_url}" target="_blank">View Image</a></p>` : ''}
                            </div>
                            <div class="issue-actions">
                                <label>Update Status:</label>
                                <select onchange="updateStatus('${issue.id}', this.value)">
                                    <option value="pending" ${issue.status === 'pending' ? 'selected' : ''}>‚è≥ Pending</option>
                                    <option value="in-progress" ${issue.status === 'in-progress' ? 'selected' : ''}>üîÑ In Progress</option>
                                    <option value="resolved" ${issue.status === 'resolved' ? 'selected' : ''}>‚úÖ Resolved</option>
                                    <option value="closed" ${issue.status === 'closed' ? 'selected' : ''}>üîí Closed</option>
                                </select>
                            </div>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = `<p>Error loading issues: ${result.message}</p>`;
                }
            } catch (error) {
                container.innerHTML = '<p>Error loading issues. Make sure XAMPP is running and database is set up.</p>';
                console.error('Error:', error);
            }
        }
        
        // Show instructions on page load
        document.addEventListener('DOMContentLoaded', function() {
            const instructions = `
                <div style="background: #e7f3ff; border: 1px solid #b6d7ff; padding: 15px; border-radius: 5px; margin: 20px 0;">
                    <h3>üöÄ Quick Setup Instructions:</h3>
                    <ol>
                        <li><strong>Start XAMPP:</strong> Apache + MySQL ‡§ï‡•ã start ‡§ï‡§∞‡•á‡§Ç</li>
                        <li><strong>Create Database:</strong> phpMyAdmin ‡§Æ‡•á‡§Ç <code>sih_project</code> database ‡§¨‡§®‡§æ‡§è‡§Ç</li>
                        <li><strong>Import Tables:</strong> <code>database.sql</code> file ‡§ï‡•ã import ‡§ï‡§∞‡•á‡§Ç</li>
                        <li><strong>Update Path:</strong> <code>php-integration.js</code> ‡§Æ‡•á‡§Ç baseURL ‡§ï‡•ã ‡§Ö‡§™‡§®‡•á path ‡§ï‡•á according update ‡§ï‡§∞‡•á‡§Ç</li>
                        <li><strong>Test:</strong> Form submit ‡§ï‡§∞‡§ï‡•á test ‡§ï‡§∞‡•á‡§Ç!</li>
                    </ol>
                    <p><strong>Note:</strong> Make sure <code>api.php</code> file is accessible at <code>http://localhost/hello/api.php</code></p>
                </div>
            `;
            document.body.insertAdjacentHTML('afterbegin', instructions);
        });
    </script>
</body>
</html>